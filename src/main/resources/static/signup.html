<!doctype html>
<html lang="ko" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
    <meta name="generator" content="Hugo 0.88.1">
    <title> 오늘 뭐 먹지? </title>

    <link rel="canonical" href="https://getbootstrap.com/docs/5.1/examples/album/">

    <!-- Bootstrap core CSS -->
    <link href="/css/bootstrap.min.css" rel="stylesheet">

    <link href="/css/mycss.css" rel="stylesheet">

    <!-- Bootstrap -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
            crossorigin="anonymous"></script>

    <!--파비콘-->
    <link rel="shortcut icon" type="image/x-icon" href="images/favicon2.ico"/>


    <!-- JS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.js"></script>

    <!-- 구글 폰트 -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Black+Han+Sans&display=swap" rel="stylesheet">

    <style>
        .bd-placeholder-img {
            font-size: 1.125rem;
            text-anchor: middle;
            -webkit-user-select: none;
            -moz-user-select: none;
            user-select: none;
        }

        @media (min-width: 768px) {
            .bd-placeholder-img-lg {
                font-size: 3.5rem;
            }
        }
    </style>
    <script>
        function is_nickname(asValue) {
            var regExp = /^(?=.*[a-zA-Z])[-a-zA-Z0-9_.]{2,10}$/;
            return regExp.test(asValue);
        }

        function is_password(asValue) {
            var regExp = /^(?=.*\d)(?=.*[a-zA-Z])[0-9a-zA-Z!@#$%^&*]{8,20}$/;
            return regExp.test(asValue);
        }

        function onclickAdmin() {
            // Get the checkbox
            var checkBox = document.getElementById("admin-check");
            // Get the output text
            var box = document.getElementById("admin-token");

            // If the checkbox is checked, display the output text
            if (checkBox.checked == true) {
                box.style.display = "block";
            } else {
                box.style.display = "none";
            }
        }

        function signup() {
            let username = $("#username").val();
            let password = $("#password").val();
            let password2 = $("#password2").val();
            let email = $("#email").val();

            if ($("#username").hasClass("is-danger")) {
                alert("아이디를 다시 확인해주세요.")
                return;
            } else if (!$("#help-id").hasClass("is-success")) {
                alert("아이디 중복확인을 해주세요.")
                return;
            }

            if (password == "") {
                $("#help-password").text("  비밀번호를 입력해주세요.").removeClass("is-safe").addClass("is-danger")
                $("#password").focus()
                return;
            } else if (!is_password(password)) {
                $("#help-password").text("  비밀번호의 형식을 확인해주세요. 영문과 숫자 필수 포함, 특수문자(!@#$%^&*) 사용가능 8-20자").removeClass("is-safe").addClass("is-danger")
                $("#password").focus()
                return
            } else {
                $("#help-password").text("  사용할 수 있는 비밀번호입니다.").removeClass("is-danger").addClass("is-success")
            }
            if (password2 == "") {
                $("#help-password2").text("  비밀번호를 입력해주세요.").removeClass("is-safe").addClass("is-danger")
                $("#password2").focus()
                return;
            } else if (password2 != password) {
                $("#help-password2").text("  비밀번호가 일치하지 않습니다.").removeClass("is-safe").addClass("is-danger")
                $("#password2").focus()
                return;
            } else {
                $("#help-password2").text("  비밀번호가 일치합니다.").removeClass("is-danger").addClass("is-success")
            }
            let info = {
                username: $("#username").val(),
                password: $("#password").val(),
                email: $("#email").val()
            }
            $.ajax({
                type: 'POST',
                url: `/signup`,
                contentType: "application/json",
                data: JSON.stringify(info),
                success: function (response) {
                    alert("회원가입이 완료되었습니다!!");
                    //화면 라우터
                    location.href = '/user/login';
                }
            })
        }

        function idCheck() {
            let username = $("#username").val()
            console.log(username)
            if (username == "") {
                $("#help-id").text("아이디를 입력해주세요.").removeClass("is-safe").addClass("is-danger")
                $("#username").focus()
                return;
            }
            if (!is_nickname(username)) {
                $("#help-id").text("아이디의 형식을 확인해주세요. 영문과 숫자, 일부 특수문자(._-) 사용 가능. 2-10자 길이").removeClass("is-safe").addClass("is-danger")
                $("#username").focus()
                return;
            }
            let info = {"username": $("#username").val()};
            $.ajax({
                type: "POST",
                url: `/signup/idcheck`,
                contentType: "application/json",
                data: JSON.stringify(info),
                success: function (response) {
                    if (response == true) {
                        alert("아이디 중복")
                        $(".help-id").text("  이미 존재하는 아이디입니다.").removeClass("is-safe").addClass("is-danger")
                        $("#username").focus()
                    } else {

                        $(".help-id").text("  사용할 수 있는 아이디입니다.").removeClass("is-danger").addClass("is-success")
                    }
                }
            });
        }

    </script>
</head>
<body>

<header>
    <!--    네비게이션바-->
    <div class="navbar navbar-dark bg-dark shadow-sm">
        <div class="nav-container">
            <div class="nav-title-box">
                <a href="#" class="title nav-text" style="padding-top: 5px;">오늘 뭐 먹지?</a>
                <a href="/" class="nave-menu-text nav-menu">뭐먹을지 추천받기</a>
                <a href="/" class="nave-menu-text nav-menu">맛있는거 추천받기</a>
                <a href="/" class="nave-menu-text nav-menu">이세상 음식 전부보기</a>
            </div>
            <biv class="nav-botton-box">
                <button class="nav-button" onclick="window.location.href = '/login.html'" id="login">로그인</button>
                <button class="nav-button" onclick="window.location.href = '/signup.html'">회원가입</button>
            </biv>
        </div>
    </div>
</header>

<main>
    <div class="log-in-box">
        <p style="margin-top:30px; margin-bottom: 5px; font-weight: bold; font-size: 12pt;">&nbsp;&nbsp;아이디</p>
        <div class="box">
            <div class="signup-button-idcheck-box"><input type="text" id="username" class="signup-input-id"
                                                          placeholder="아이디"></div>
            <div class="signup-button-idcheck-box">
                <button class="signup-button-idcheck" onclick="idCheck()">중복확인</button>
            </div>
        </div>
        <div class="help help-id" id="help-id">&nbsp;&nbsp;영문과 숫자 사용 가능. 2-10자 길이</div>
        <p style="margin-top:15px; margin-bottom: 5px; font-weight: bold; font-size: 12pt;">&nbsp;&nbsp;비밀번호</p>
        <input type="password" id="password" placeholder="비밀번호" class="signup-input">
        <div class="help help-password" id="help-password">&nbsp;&nbsp;영문과 숫자 필수 포함, 특수문자(!@#$%^&*) 사용가능 8-20자</div>
        <input type="password" id="password2" placeholder="비밀번호 재입력" class="signup-input" style="margin-top: 10px;">
        <div class="help help-password" id="help-password2">&nbsp;&nbsp;비밀번호를 다시 입력해주세요.</div>
        <p style="margin-top:15px; margin-bottom: 5px; font-weight: bold; font-size: 12pt;">&nbsp;&nbsp;이메일</p>
        <input type="password" id="email" placeholder="이메일" class="signup-input">
        <button onclick="signup()" class="signup-button" style="width: 100%; margin: 20px 0 0;">회원가입</button>
    </div>
</main>
</body>
</html>